{"remainingRequest":"/Users/robin/Desktop/Heart's Journey/src/vue-web/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/robin/Desktop/Heart's Journey/src/vue-web/front/src/pages/exam/exam.vue?vue&type=style&index=0&id=8b9d6a8a&rel=stylesheet%2Fscss&lang=scss&scoped=true","dependencies":[{"path":"/Users/robin/Desktop/Heart's Journey/src/vue-web/front/src/pages/exam/exam.vue","mtime":1741004935260},{"path":"/Users/robin/Desktop/Heart's Journey/src/vue-web/front/node_modules/css-loader/dist/cjs.js","mtime":1741004933828},{"path":"/Users/robin/Desktop/Heart's Journey/src/vue-web/front/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1741004935128},{"path":"/Users/robin/Desktop/Heart's Journey/src/vue-web/front/node_modules/postcss-loader/src/index.js","mtime":1741004934560},{"path":"/Users/robin/Desktop/Heart's Journey/src/vue-web/front/node_modules/sass-loader/dist/cjs.js","mtime":1741004934920},{"path":"/Users/robin/Desktop/Heart's Journey/src/vue-web/front/node_modules/cache-loader/dist/cjs.js","mtime":1741004933467},{"path":"/Users/robin/Desktop/Heart's Journey/src/vue-web/front/node_modules/vue-loader/lib/index.js","mtime":1741004935128}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci50b3AtY29udGVudCB7CgloZWlnaHQ6IDgwcHg7Cgl3aWR0aDogMTAwJTsKCWJhY2tncm91bmQtY29sb3I6ICM0MDlFRkY7CglkaXNwbGF5OiBmbGV4OwoJanVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwp9Ci50b3AtY29udGVudC1sZWZ0LCAudG9wLWNvbnRlbnQtY2VudGVyLCAudG9wLWNvbnRlbnQtcmlnaHQgewoJZm9udC1zaXplOiAxOHB4OwoJbGluZS1oZWlnaHQ6IDgwcHg7Cgljb2xvcjogI2ZmZjsKfQoudG9wLWNvbnRlbnQtbGVmdCB7CglwYWRkaW5nLWxlZnQ6IDIwcHg7Cn0KLnRvcC1jb250ZW50LXJpZ2h0IHsKCXBhZGRpbmctcmlnaHQ6IDIwcHg7Cn0KLnF1ZXN0aW9uLWNvbnRlbnQgewoJd2lkdGg6IDkwJTsKCW1hcmdpbjogMCBhdXRvOwoJbWFyZ2luLXRvcDogMzBweDsKCWJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlOwp9Ci5xdWVzdGlvbi1jb250ZW50Omxhc3Qtb2YtdHlwZSB7Cglib3JkZXI6IG5vbmU7Cn0KLnF1ZXN0aW9uLXRpdGxlLCAucXVlc3Rpb24tYW5zd2VyLCAucXVlc3Rpb24tYnRuIHsKCXBhZGRpbmc6IDIwcHggMDsKfQo="},{"version":3,"sources":["exam.vue"],"names":[],"mappings":";AAyQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"exam.vue","sourceRoot":"src/pages/exam","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"top-content\">\r\n\t\t\t<div class=\"top-content-left\">{{paper.name}} （ 共 <el-tag type=\"danger\">{{questionList.length}}</el-tag> 题 ）\r\n\t\t\t</div>\r\n\t\t\t<div class=\"top-content-center\" v-cloak>距离测试结束还有 <el-tag type=\"danger\">{{this.hour}}</el-tag> 时 <el-tag\r\n\t\t\t\t\ttype=\"danger\">{{this.minute}}</el-tag> 分 <el-tag type=\"danger\">{{this.second}}</el-tag> 秒</div>\r\n\t\t\t<div class=\"top-content-right\">\r\n\t\t\t\t<el-button type=\"danger\" @click=\"doneExam(0)\">结束测试</el-button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<el-card v-if=\"end\" style=\"width: 90%;margin: 10px auto;\">\r\n\t\t\t<div style=\"width: 100%;display: flex;flex-direction: column;align-items: center;\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div class=\"question-title\">测试成绩：<el-tag type=\"danger\">{{scoreChange()}}</el-tag> 分</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"question-title\">您的心理{{determineForm.determine}}</div>\r\n\t\t\t\t<div class=\"question-title\" style=\"width: 60%;\">分析：{{determineForm.analysis}}</div>\r\n\t\t\t\t<div class=\"question-btn\">\r\n\t\t\t\t\t<el-button v-if=\"!isSubmit\" type=\"primary\" @click=\"isSubmit=true\">查看解析</el-button>\r\n\t\t\t\t\t<el-button type=\"success\" @click=\"doneExam(1)\">结束测试</el-button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</el-card>\r\n\t\t<el-card style=\"width: 90%;margin: 10px auto;\" v-if=\"!end||isSubmit\">\r\n\t\t\t<div class=\"question-content\" v-for=\"(item, index) in questionList\" :key=\"item.id\">\r\n\t\t\t\t<div class=\"question-title\">\r\n\t\t\t\t\t{{index + 1}} 、{{item.type==4?`(${item.score}分)`:''}}：<span class=\"ql-snow ql-editor\" v-html=\"item.questionname\"></span>\r\n\t\t\t\t\t<el-tag type=\"success\" v-if=\"item.type==0\">{{questionType(item)}}</el-tag>\r\n\t\t\t\t\t<el-tag type=\"danger\" v-if=\"item.type==4\">{{questionType(item)}}</el-tag>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"question-answer\">\r\n\t\t\t\t\t<div v-if=\"!isSubmit && !end\">\r\n\t\t\t\t\t\t作答：\r\n\t\t\t\t\t\t<el-select v-model=\"item.myanswer\" placeholder=\"请选择您的答案\"\r\n\t\t\t\t\t\t\tv-if=\"item.type == 0 \">\r\n\t\t\t\t\t\t\t<el-option v-for=\"(option, idx) in JSON.parse(item.options)\" :key=\"idx\" :label=\"option.text\"\r\n\t\t\t\t\t\t\t\t:value=\"option.code\">\r\n\t\t\t\t\t\t\t</el-option>\r\n\t\t\t\t\t\t</el-select>\r\n\t\t\t\t\t\t<el-input style=\"width: 400px;\" v-if=\"item.type == 4\" v-model=\"item.myanswer\" type=\"textarea\"\r\n\t\t\t\t\t\t\tplaceholder=\"请输入答案\"></el-input>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div v-if=\"isSubmit\">\r\n\t\t\t\t\t\t<div class=\"question-title\">填写答案：\r\n\t\t\t\t\t\t\t{{item.myanswer}}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"question-title\">\r\n\t\t\t\t\t\t\t解析：{{item.answer?(item.answer + ','):''}} {{item.analysis}}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"question-btn\">\r\n\t\t\t\t<el-button v-if=\"!isSubmit && !end\" type=\"primary\" @click=\"submitAnswer\">提交答案</el-button>\r\n\t\t\t</div>\r\n\t\t</el-card>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n    //数据集合\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tquestionList: [],\r\n\t\t\t\tisSubmit: false,\r\n\t\t\t\tend: false,\r\n\t\t\t\tmaxtime: 0,\r\n\t\t\t\ttimer: null,\r\n\t\t\t\thour: '',\r\n\t\t\t\tminute: '',\r\n\t\t\t\tsecond: '',\r\n\t\t\t\tuser: {},\r\n\t\t\t\thassubject:false,\r\n\t\t\t\tpaper:{},\r\n\t\t\t\tdetermineForm: {},\r\n\t\t\t\tdetermineList: [],\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.$http.get(`exampaper/info/${this.$route.query.id}`, {}).then(res => {\r\n\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\tthis.paper = res.data.data\r\n\t\t\t\t\tthis.maxtime = this.paper.time * 60;\r\n\t\t\t\t\tthis.deleteRecords(this.paper.id);\r\n\t\t\t\t\tthis.getQuestion(this.paper.id);\r\n\t\t\t\t\tthis.hour = Math.floor(this.maxtime / 60 / 60);\r\n\t\t\t\t\tthis.minute = Math.floor(this.maxtime / 60 % 60);\r\n\t\t\t\t\tthis.second = Math.floor(this.maxtime % 60);\r\n\t\t\t\t\tthis.timer = setInterval(this.countDown, 1000);\r\n\t\t\t\t\tthis.$http.get('scoredetermination/list',{params: {paperid: this.paper.id,page: 1,limit : 100,sort: 'score',order:'desc'}}).then(rs=>{\r\n\t\t\t\t\t\tthis.determineList = rs.data.data.list\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.$http.get(localStorage.getItem('UserTableName') + '/session', {\r\n\t\t\t\temulateJSON: true\r\n\t\t\t}).then(res => {\r\n\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\tthis.user = res.data.data;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//方法集合\r\n\t\tmethods: {\r\n\t\t\tquestionType(item) {\r\n\t\t\t\tswitch (item.type) {\r\n\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\treturn '客观题';\r\n\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\treturn '主观题';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeleteRecords(paperid) {\r\n\t\t\t\tthis.$http.post(`examrecord/deleteRecords?userid=${localStorage.getItem('frontUserid')}&paperid=${paperid}`).then(res => {});\r\n\t\t\t},\r\n\t\t\tgetQuestion(paperid) {\r\n\t\t\t\tthis.$http.get('examquestion/list', {params: {page: 1, limit: 1000, paperid}}).then(res => {\r\n\t\t\t\t\tif (res.data.code == 0) {\r\n\t\t\t\t\t\tfor(let x in res.data.data.list){\r\n\t\t\t\t\t\t\tres.data.data.list[x].questionname = res.data.data.list[x].questionname.replace(/img src/gi,\"img style=\\\"width:100%;\\\" src\");\r\n\t\t\t\t\t\t\tif(res.data.data.list[x].type==4){\r\n\t\t\t\t\t\t\t\tthis.hassubject = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tres.data.data.list.sort(function (a, b) {\r\n\t\t\t\t\t\t\treturn (b.sequence - a.sequence)\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.questionList = res.data.data.list;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsubmitAnswer() {\r\n\t\t\t\tfor(let i in this.questionList){\r\n\t\t\t\t\tif(this.questionList[i].type==1){\r\n\t\t\t\t\t\tif(!this.questionList[i].myanswer||(this.questionList[i].myanswer&&this.questionList[i].myanswer.length==0)){\r\n\t\t\t\t\t\t\tthis.$message.error('还有试题未完成作答')\r\n\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tif(!this.questionList[i].myanswer||(this.questionList[i].myanswer&&this.questionList[i].myanswer=='')){\r\n\t\t\t\t\t\t\tthis.$message.error('还有试题未完成作答')\r\n\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.$confirm(`是否完成作答，提交心理测评？`, \"提示\", {\r\n\t\t\t\t\tconfirmButtonText: \"确定\",\r\n\t\t\t\t\tcancelButtonText: \"取消\",\r\n\t\t\t\t\ttype: \"warning\"\r\n\t\t\t\t}).then(()=>{\r\n\t\t\t\t\tfor (let x in this.questionList) {\r\n\t\t\t\t\t\tif (this.questionList[x].type != 4) {\r\n\t\t\t\t\t\t\tthis.questionList[x].optionList = JSON.parse(this.questionList[x].options)\r\n\t\t\t\t\t\t\tfor(let i in this.questionList[x].optionList){\r\n\t\t\t\t\t\t\t\tif(this.questionList[x].myanswer == this.questionList[x].optionList[i].code){\r\n\t\t\t\t\t\t\t\t\tthis.questionList[x].myscore = this.questionList[x].optionList[i].score\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.questionList[x].myscore = 0\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.saverecord(this.questionList[x])\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.end = true;\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tscoreChange() {\r\n\t\t\t\tlet score = 0\r\n\t\t\t\tfor (let x in this.questionList) {\r\n\t\t\t\t\tif (this.questionList[x].myscore) {\r\n\t\t\t\t\t\tscore += Number(this.questionList[x].myscore) || 0\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor(let i in this.determineList){\r\n\t\t\t\t\tif(score >= this.determineList[i].score){\r\n\t\t\t\t\t\tthis.determineForm = this.determineList[i]\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn score\r\n\t\t\t},\r\n\t\t\tsaverecord(row) {\r\n\t\t\t\tlet record = {\r\n\t\t\t\t\tuserid: this.user.id,\r\n\t\t\t\t\tusername: this.user.yonghuxingming,\r\n\t\t\t\t\tpaperid: this.paper.id,\r\n\t\t\t\t\tpapername: this.paper.name,\r\n\t\t\t\t\tquestionid: row.id,\r\n\t\t\t\t\tquestionname: row.questionname,\r\n\t\t\t\t\toptions: row.options,\r\n\t\t\t\t\tscore: row.score,\r\n\t\t\t\t\tanalysis: row.analysis,\r\n\t\t\t\t\tmyscore: row.myscore,\r\n\t\t\t\t\tmyanswer: row.myanswer,\r\n\t\t\t\t\ttype: row.type,\r\n\t\t\t\t\tismark: this.hassubject ? 0 : 1\r\n\t\t\t\t}\r\n\t\t\t\tthis.$http.post('examrecord/add', record).then(res => {})\r\n\t\t\t},\r\n\t\t\tdoneExam(type) {\r\n\t\t\t\tif (type == 0) {\r\n\t\t\t\t\tthis.$confirm('确定离开测试?未答题目按0分计', '提示', {\r\n\t\t\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t\t}).then(() => {\r\n\t\t\t\t\t\tthis.end = true;\r\n\t\t\t\t\t\tif (this.questionList.length == 0) {\r\n\t\t\t\t\t\t\tthis.$router.push('/index/examPaper');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$router.push('/index/examPaper');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcountDown() {\r\n\t\t\t\tif (this.maxtime > 0) {\r\n\t\t\t\t\tthis.hour = Math.floor((this.maxtime - 1) / 60 / 60);\r\n\t\t\t\t\tthis.minute = Math.floor((this.maxtime - 1) / 60 % 60);\r\n\t\t\t\t\tthis.second = Math.floor((this.maxtime - 1) % 60);\r\n\t\t\t\t\t--this.maxtime;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tclearInterval(this.timer);\r\n\t\t\t\t\tthis.end = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\r\n\t.top-content {\r\n\t\theight: 80px;\r\n\t\twidth: 100%;\r\n\t\tbackground-color: #409EFF;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\t.top-content-left, .top-content-center, .top-content-right {\r\n\t\tfont-size: 18px;\r\n\t\tline-height: 80px;\r\n\t\tcolor: #fff;\r\n\t}\r\n\t.top-content-left {\r\n\t\tpadding-left: 20px;\r\n\t}\r\n\t.top-content-right {\r\n\t\tpadding-right: 20px;\r\n\t}\r\n\t.question-content {\r\n\t\twidth: 90%;\r\n\t\tmargin: 0 auto;\r\n\t\tmargin-top: 30px;\r\n\t\tborder-bottom: 1px solid #eee;\r\n\t}\r\n\t.question-content:last-of-type {\r\n\t\tborder: none;\r\n\t}\r\n\t.question-title, .question-answer, .question-btn {\r\n\t\tpadding: 20px 0;\r\n\t}\r\n</style>\r\n"]}]}